# 함수형 프로그래밍은 무엇인가요?

1. <u>수학 함수</u>를 사용하고 <u>부수 효과</u>를 피하는 것이 특징인 프로그래밍 패러다임
2. <u>부수 효과</u>없이 <u>순수 함수</u>만 사용하는 프로그래밍 스타일

### 부수 효과란?

- 함수가 리턴값이외에 하는 모든 일
- 예시:
  - 전역 변수 수정
  - 파일 시스템에 접근
  - 데이터베이스에 쓰기
  - 사용자 입력 받기
  - 콘솔에 출력하기
- 함수를 호출 할 때마다 발생
  - 리턴값이 필요해서 호출했지만, 불필요한 부수 효과가 발생할 수 있음

### 순수 함수란?

- 인자에만 의존하고 부수 효과가 없는 함수
- 예시:
  - 두 수의 합을 구하는 함수
    ```javascript
    function add(a, b) {
      return a + b;
    }
    ```
- 같은 인자를 넣으면 항상 같은 결과 도출
- <u>수학 함수</u>라고 볼 수 있음

함수형 프로그래머는 항상 부수 효과를 피하고, 순수 함수만 사용해야 할 것 같지만, 실제로는 그 반대이다.

# 실용적인 측면에서 함수형 프로그래밍 정의의 문제점

- 위 내용은 실용적인 측면에서 3가지 문제 존재

### 문제 1. 부수 효과는 필요하다.

- 부수 효과를 피하라고 하지만, 부수 효과는 소프트웨어의 이유

### 문제 2. 함수형 프로그래밍은 부수 효과를 다루기 용이하다.

- 함수형 프로그래머는 부수 효과를 다루기 위한 도구 사용에 익숙함
- 실제로 순수하지 않은 함수를 잘 사용할 수 있는 기술이 다수 존재

### 문제 3. 함수형 프로그래밍은 실용적이다.

- 실제 소프트웨어 개발에서 사용중

# 액션과 계산, 데이터 구분하기

- 함수형 프로그래머는 직감적으로 코드를 세 분류로 나눔

### 1. 액션

- 호출하는 시점과 횟수에 의존

### 2. 계산

- 호출 시점이나 횟수는 중요하지 않음
- 실행이 가능
- 실행하기 전까지 어떻게 동작할지 알 수 없음

### 3. 데이터

- 호출 시점이나 횟수는 중요하지 않음
- 실행 불가
- 정적이며, 보이는 그대로

함수형 프로그래밍 기술과 개념은 코드를 액션, 계산, 데이터로 구분하는 것부터 시작한다.

# 액션과 계산, 데이터를 구분했을 때 장점

- 실행 시점이나 횟수에 의존하는 코드를 없애면, 코드를 더 쉽게 이해하고, 심각한 버그를 해결 能
- 데이터와 계산으로 바꿀수록 분산 시스템에서 생기는 여러가지 문제 해결 能
- 분산 시스템이 아무리 불확실성을 가지고 있다고 해도, 액션을 안전하게 다룰 수 있는 기술 有
- 코드의 많은 부분을 액션에서 계산으로 변경하면 결과적으로 액션도 다루기 쉬워짐

결론은 복잡성을 낮출 수 있다.

### 분산 시스템 규칙 3가지

1. 메시지 순서가 바뀔 수 있음
2. 메시지는 한 번 이상 도착할 수도 있고, 도착하지 않을 수도 있음
3. 응답을 받지 못하면 어떤 일이 발생했는지 알 수 없음

# 변경 가능성에 따라 코드 나누기

### 계층화 설계

- 각 계층은 그 아래에 있는 계층을 기반으로 생성
- 각 계층에 있는 코드는 더 안정적인 기반 위에 생성 가능
- 가장 위 계층에 있는 코드는 의존성이 거의 없기 때문에 쉽게 변경 가능
- 아래에 있는 코드들은 위에 있는 코드보다 의존성이 많아 바꾸기 어렵지만, 자주 바뀌지 않음

이 설계는 일반적으로 <u>비즈니스 규칙 -> 도메인 규칙 -> 기술 스택</u> 계층으로 나뉜다.
이 설계를 이용한 코드는 테스트, 재사용, 유지보수가 용이

# 일급 추상

### 타임라인 다이어그램

- 액션이 시간 순서에 따라 어떻게 실행되는지 볼 수 있도록 작성하는 것
- 액션은 실행시점에 의존 -> 실행 순서가 중요
- 분산 시스템은 각 시스템마다 각자 타임라인을 보유
- 시스템끼리 타임라인 순서 맞추는 기능은 없음
- <u>타임라인을 서로 맞추지 않은 분산 시스템은 예측 불가능한 순서로 실행</u>

### 타임라인 커팅

- 서로 순서를 맞추는 방법
- 고차 동작(고차 함수로 만든 동작)으로 구현

## 요점 정리

1. **액션과 계산, 데이터**에 대해 다루면서 구분하기기
2. 유지보수를 위해 코드의 변경 가능성에 따라 **계층형 설계**하기기
3. 액션이 다른 액션과 어떻게 연결되는지 볼 수 있는 **타임라인 다이어그램** 그리기기
4. 액션이 올바른 순서로 실행할 수 있도록 보장해주는 **타임라인 커팅** 하기

# 액션과 계산, 데이터

### 액션

- 실행 시점과 횟수에 의존
- 다른 말로 **부수 효과**, **순수하지 않은 함수** 라고 부름
- 예시:
  - 이메일 보내기
  - 데이터베이스 읽기

### 계산

- 입력으로 출력을 계산
- 다른 말로 **순수 함수**, **수학 함수** 라고 부름
- 예시:
  - 최댓값 찾기, 이메일 주소 확인하기

### 데이터

- 이벤트에 대한 사실
- 예시:
  - 사용자가 입력한 이메일 주소, 은행 API로 읽은 달러 수량

## 액션과 계산, 데이터 구분 기술

### 1. 문제에 대해 생각할 때

- 문제 자체에 대해 고민할 때 액션, 계산, 데이터로 나눠 생각하기
- 나눠 생각하면 코드를 작성하기 편함

### 2. 코딩할 때

- 코드를 작성할 때도 구분 가능
- 함수형 프로그래머는 최대한 액션에서 계산을 분리하려고 함
- 계산에서 데이터를 분리할 수 있는지 생각
- 액션이 계산이 될 수 있는지, 계산은 데이터가 될 수 있는지 고민

### 3. 코드 리딩

- 코드가 어떤 것에 속하는 잘 살펴보기
- 특히 액션은 시간에 의존하기 때문에 더 조심해야 함
- 숨어있는 액션까지도 찾아야 함

## 이미 있는 코드에 함수형 사고 적용하기

- 코드를 읽을 때도 액션과 계산, 데이터 관점으로 리딩

### 액션은 코드 전체로 퍼진다

- 액션을 만들고 해당 액션을 부르는 함수가 있다면 그 함수도 액션
- 작은 액션 하나가 코드 전체로 퍼져 나감
- 그렇기 때문에 함수형 프로그래머는 액션을 최대한 사용하지 않으려고 함

### 액션은 다양한 형태로 나타난다

- 자바스크립트에서 발생할 수 있는 액션
- 예시:
  - 함수 호출 - alert();
  - 메서드 호출 - console.log();
  - 생성자 - new Date();
  - 표현식 - 변수 참조, 속성 참조, 배열 참조 -> 공유되고, 변경이 가능하다면 읽는 시점에 따라 값이 다를 수 있기 때문에 액션
  - 상태 - 값 할당, 속성 삭제 -> 다른 코드에 영향을 주기 때문에 액션
- 언제 부르는지, 얼마나 부르는지에 따라 다른 결과 도출
- 어느 곳에서나 사용이 가능하기 때문에 코드 전체로 퍼지기 쉬움
- 코드를 모두 찾기 보다는, 코드가 호출 시점이나 횟수에 의존하는지 생각하기
